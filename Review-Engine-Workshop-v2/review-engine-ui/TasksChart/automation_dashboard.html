<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Automation Dashboard - Flyout Details</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .overview-section {
            padding: 40px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .instruction-box {
            background: #cce5ff;
            border-left: 4px solid #3498db;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 4px;
            color: #2c5aa0;
            font-size: 14px;
            line-height: 1.5;
        }

        .details-section {
            padding: 40px;
        }

        .details-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 30px;
            color: #2c3e50;
            text-align: center;
        }

        .category-panels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .category-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .category-card:hover {
            border-color: #667eea;
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);
        }

        .category-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-card .badge {
            display: inline-block;
            background: #e6fffa;
            color: #0d7377;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .stat {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .flyout-detail {
            display: none;
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #f0f4ff 100%);
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .flyout-detail.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .flyout-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2c3e50;
            text-align: center;
        }

        .task-class {
            margin-bottom: 25px;
            background: white;
            padding: 20px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }

        .task-class-name {
            font-size: 14px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .task-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .task-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .task-name {
            font-size: 13px;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
        }

        .task-bar-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
        }

        .task-bar {
            flex: 1;
            height: 24px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            display: flex;
        }

        .task-bar-manual {
            background: #E74C3C;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 11px;
            font-weight: 600;
            opacity: 0.8;
        }

        .task-bar-auto {
            background: #27AE60;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 11px;
            font-weight: 600;
        }

        .task-hours {
            font-size: 12px;
            font-weight: 600;
            color: #666;
            min-width: 60px;
            text-align: right;
        }

        .task-pct {
            font-size: 11px;
            background: #e6fffa;
            color: #0d7377;
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: 600;
            min-width: 50px;
            text-align: center;
        }

        .close-button {
            background: #f0f0f0;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #666;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .close-button:hover {
            background: #667eea;
            color: white;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 500;
        }

        .legend-box {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .legend-manual {
            background: #E74C3C;
            opacity: 0.8;
        }

        .legend-auto {
            background: #27AE60;
        }

        @media (max-width: 768px) {
            .category-panels {
                grid-template-columns: 1fr;
            }

            .summary-stats {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 24px;
            }

            .task-bar-container {
                flex-wrap: wrap;
            }

            .task-hours {
                min-width: auto;
            }

            .task-pct {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Weekly Time Investment by Category</h1>
            <p>Interactive Overview with Detailed Task Breakdowns</p>
        </div>

        <div class="overview-section">
            <div class="instruction-box">
                üí° <strong>HOVER & CLICK:</strong> Click any category card below to see detailed breakdown with task classes and individual activities. Each task shows manual hours (red) vs automatable hours (green) with automation percentage.
            </div>

            <div class="chart-container">
                <canvas id="overviewChart"></canvas>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-box legend-manual"></div>
                    <span>Manual Hours Remaining</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box legend-auto"></div>
                    <span>Automatable Hours</span>
                </div>
            </div>
        </div>

        <div class="details-section">
            <div class="details-title">üéØ Detailed Task Breakdowns by Category</div>

            <div class="category-panels" id="categoryPanels"></div>

            <div id="flyoutContainer"></div>
        </div>
    </div>

    <script>
        const taskData = [
            {
                category: "Digital marketing",
                totals: {
                    hours_per_week: 9.25,
                    hours_saved_per_week: 6.25,
                    automation_pct: 0.68
                },
                classes: [
                    {
                        name: "Campaign planning & execution",
                        tasks: [
                            { task: "Build/send routine email campaigns", hours_per_week: 1.5, hours_saved_per_week: 1.0 },
                            { task: "Configure basic campaigns (budgets, geo, etc.)", hours_per_week: 1.0, hours_saved_per_week: 0.5 }
                        ]
                    },
                    {
                        name: "Lists & content distribution",
                        tasks: [
                            { task: "List maintenance & segmentation", hours_per_week: 1.0, hours_saved_per_week: 0.7 },
                            { task: "Clone/update landing pages", hours_per_week: 1.0, hours_saved_per_week: 0.7 },
                            { task: "Upload creatives to ad platforms", hours_per_week: 0.75, hours_saved_per_week: 0.5 },
                            { task: "Maintain content calendar sheet", hours_per_week: 0.5, hours_saved_per_week: 0.25 }
                        ]
                    },
                    {
                        name: "Tracking & reporting",
                        tasks: [
                            { task: "UTM tagging & link setup", hours_per_week: 0.5, hours_saved_per_week: 0.4 },
                            { task: "Export/import performance reports (CSV work)", hours_per_week: 0.75, hours_saved_per_week: 0.6 },
                            { task: "Compile weekly/monthly KPI reports", hours_per_week: 0.75, hours_saved_per_week: 0.6 }
                        ]
                    },
                    {
                        name: "Coordination & support",
                        tasks: [
                            { task: "Reconcile ad spend vs. billing", hours_per_week: 0.5, hours_saved_per_week: 0.3 },
                            { task: "Respond to list-related emails (subscriptions/preferences)", hours_per_week: 0.5, hours_saved_per_week: 0.25 },
                            { task: "Brief designers/writers and manage revisions", hours_per_week: 0.5, hours_saved_per_week: 0.25 }
                        ]
                    }
                ]
            },
            {
                category: "Social media",
                totals: {
                    hours_per_week: 11.25,
                    hours_saved_per_week: 6.5,
                    automation_pct: 0.58
                },
                classes: [
                    {
                        name: "Content planning & scheduling",
                        tasks: [
                            { task: "Draft & schedule posts across platforms", hours_per_week: 3.0, hours_saved_per_week: 2.0 },
                            { task: "Maintain social asset library", hours_per_week: 0.5, hours_saved_per_week: 0.25 },
                            { task: "Manually post stories/reels/shorts", hours_per_week: 1.0, hours_saved_per_week: 0.5 }
                        ]
                    },
                    {
                        name: "Creative formatting",
                        tasks: [
                            { task: "Resize/reformat images and video", hours_per_week: 0.75, hours_saved_per_week: 0.5 }
                        ]
                    },
                    {
                        name: "Community management",
                        tasks: [
                            { task: "Standard replies to FAQs in comments/DMs", hours_per_week: 0.75, hours_saved_per_week: 0.5 },
                            { task: "Monitor DMs & comments (triage)", hours_per_week: 1.5, hours_saved_per_week: 0.75 },
                            { task: "Log mentions and reviews into CRM/sheets", hours_per_week: 0.5, hours_saved_per_week: 0.4 },
                            { task: "Collect and tag UGC for reuse", hours_per_week: 0.5, hours_saved_per_week: 0.3 }
                        ]
                    },
                    {
                        name: "Analytics & optimization",
                        tasks: [
                            { task: "Export engagement and reach reports", hours_per_week: 0.5, hours_saved_per_week: 0.4 },
                            { task: "Compile 'top posts' / best performers list", hours_per_week: 0.5, hours_saved_per_week: 0.4 },
                            { task: "Update bios, links, pins, and highlights", hours_per_week: 0.25, hours_saved_per_week: 0.15 },
                            { task: "Research hashtags/leads and log to CRM", hours_per_week: 1.0, hours_saved_per_week: 0.6 }
                        ]
                    }
                ]
            },
            {
                category: "Loyalty rewards program",
                totals: {
                    hours_per_week: 7.25,
                    hours_saved_per_week: 4.25,
                    automation_pct: 0.59
                },
                classes: [
                    {
                        name: "Enrollment & data sync",
                        tasks: [
                            { task: "Enroll customers manually at POS/web", hours_per_week: 1.0, hours_saved_per_week: 0.7 },
                            { task: "Import/export transaction files", hours_per_week: 0.75, hours_saved_per_week: 0.6 }
                        ]
                    },
                    {
                        name: "Account maintenance & support",
                        tasks: [
                            { task: "Fix point-balance issues and discrepancies", hours_per_week: 0.75, hours_saved_per_week: 0.5 },
                            { task: "Handle basic redemption support tickets", hours_per_week: 0.75, hours_saved_per_week: 0.4 }
                        ]
                    },
                    {
                        name: "Campaign operations",
                        tasks: [
                            { task: "Send birthday/anniversary/'we miss you' campaigns", hours_per_week: 0.5, hours_saved_per_week: 0.4 },
                            { task: "Manage promo codes and expirations", hours_per_week: 0.75, hours_saved_per_week: 0.4 },
                            { task: "Configure simple earn/burn promos", hours_per_week: 0.5, hours_saved_per_week: 0.3 }
                        ]
                    },
                    {
                        name: "Analytics, partners & governance",
                        tasks: [
                            { task: "Reconcile points liability reports", hours_per_week: 0.75, hours_saved_per_week: 0.4 },
                            { task: "Weekly program performance reporting", hours_per_week: 0.5, hours_saved_per_week: 0.35 },
                            { task: "Generate/send partner settlement files", hours_per_week: 0.5, hours_saved_per_week: 0.3 },
                            { task: "Staff training refreshers & updates", hours_per_week: 0.5, hours_saved_per_week: 0.2 },
                            { task: "Competitive program monitoring & notes", hours_per_week: 0.5, hours_saved_per_week: 0.2 }
                        ]
                    }
                ]
            },
            {
                category: "Ecommerce (web & mobile)",
                totals: {
                    hours_per_week: 14.25,
                    hours_saved_per_week: 9.25,
                    automation_pct: 0.65
                },
                classes: [
                    {
                        name: "Catalog & merchandising",
                        tasks: [
                            { task: "Create/update product listings", hours_per_week: 2.0, hours_saved_per_week: 1.0 },
                            { task: "Adjust prices & discounts for promos", hours_per_week: 1.0, hours_saved_per_week: 0.6 },
                            { task: "Update homepage banners/collections", hours_per_week: 1.0, hours_saved_per_week: 0.6 }
                        ]
                    },
                    {
                        name: "Inventory & order flow",
                        tasks: [
                            { task: "Sync inventory across channels", hours_per_week: 1.0, hours_saved_per_week: 0.7 },
                            { task: "Process routine orders & shipping labels", hours_per_week: 2.0, hours_saved_per_week: 1.4 },
                            { task: "Coordinate pick/pack/ship with in-house or 3PL", hours_per_week: 1.5, hours_saved_per_week: 0.8 }
                        ]
                    },
                    {
                        name: "Customer service & cart recovery",
                        tasks: [
                            { task: "Handle standard returns & refunds", hours_per_week: 1.5, hours_saved_per_week: 0.9 },
                            { task: "Answer repetitive pre-purchase questions", hours_per_week: 1.0, hours_saved_per_week: 0.6 },
                            { task: "Monitor abandoned carts & send reminders", hours_per_week: 0.75, hours_saved_per_week: 0.6 }
                        ]
                    },
                    {
                        name: "Reporting & configuration",
                        tasks: [
                            { task: "Download & reconcile sales reports", hours_per_week: 1.0, hours_saved_per_week: 0.7 },
                            { task: "Maintain tax/shipping tables", hours_per_week: 0.75, hours_saved_per_week: 0.4 },
                            { task: "Tag/categorize orders/customers in CRM", hours_per_week: 0.75, hours_saved_per_week: 0.5 }
                        ]
                    }
                ]
            }
        ];

        // Create overview chart
        function createOverviewChart() {
            const categories = taskData.map(d => d.category);
            const totalHours = taskData.map(d => d.totals.hours_per_week);
            const savedHours = taskData.map(d => d.totals.hours_saved_per_week);
            const remainingHours = totalHours.map((t, i) => t - savedHours[i]);

            const ctx = document.getElementById('overviewChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categories,
                    datasets: [
                        {
                            label: 'Manual Hours Remaining',
                            data: remainingHours,
                            backgroundColor: '#E74C3C',
                            borderColor: 'white',
                            borderWidth: 2,
                            borderRadius: 4,
                            barPercentage: 0.7,
                            order: 2
                        },
                        {
                            label: 'Automatable Hours',
                            data: savedHours,
                            backgroundColor: '#27AE60',
                            borderColor: 'white',
                            borderWidth: 2,
                            borderRadius: 4,
                            barPercentage: 0.7,
                            order: 2
                        }
                    ]
                },
                options: {
                    indexAxis: 'x',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: { size: 13, weight: 'bold' },
                                padding: 20,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 12,
                            titleFont: { size: 13, weight: 'bold' },
                            bodyFont: { size: 12 },
                            callbacks: {
                                afterLabel: function(context) {
                                    const datasetIndex = context.datasetIndex;
                                    const index = context.dataIndex;
                                    const total = totalHours[index];
                                    const saved = savedHours[index];
                                    const pct = Math.round((saved / total) * 100);
                                    return `Automation: ${pct}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            ticks: { font: { size: 12, weight: '500' } }
                        },
                        y: {
                            stacked: true,
                            title: { display: true, text: 'Hours per Week', font: { size: 12, weight: 'bold' } },
                            ticks: { font: { size: 11 } }
                        }
                    }
                }
            });
        }

        // Create category cards and flyout panels
        function createCategoryPanels() {
            const panelsContainer = document.getElementById('categoryPanels');
            const flyoutContainer = document.getElementById('flyoutContainer');

            taskData.forEach((data, index) => {
                // Category Card
                const card = document.createElement('div');
                card.className = 'category-card';
                card.onclick = () => toggleFlyout(index);

                const automationPct = Math.round(data.totals.automation_pct * 100);
                card.innerHTML = `
                    <h3>üìç ${data.category}</h3>
                    <div class="summary-stats">
                        <div class="stat">
                            <div class="stat-value">${data.totals.hours_per_week.toFixed(2)}</div>
                            <div class="stat-label">Total Hours/Week</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${data.totals.hours_saved_per_week.toFixed(2)}</div>
                            <div class="stat-label">Automatable Hours</div>
                        </div>
                    </div>
                    <div class="badge">${automationPct}% automation potential</div>
                `;
                panelsContainer.appendChild(card);

                // Flyout Detail Panel
                const flyout = document.createElement('div');
                flyout.className = 'flyout-detail';
                flyout.id = `flyout-${index}`;

                let flyoutHTML = `<div class="flyout-title">üéØ ${data.category} - Detailed Task Breakdown</div>`;

                // Summary stats in flyout
                flyoutHTML += `
                    <div class="summary-stats" style="grid-template-columns: repeat(3, 1fr); margin-bottom: 25px;">
                        <div class="stat">
                            <div class="stat-value">${data.totals.hours_per_week.toFixed(2)}</div>
                            <div class="stat-label">Total Weekly Hours</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${data.totals.hours_saved_per_week.toFixed(2)}</div>
                            <div class="stat-label">Automatable Hours</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${automationPct}%</div>
                            <div class="stat-label">Automation Potential</div>
                        </div>
                    </div>
                `;

                // Task classes and tasks
                data.classes.forEach(taskClass => {
                    flyoutHTML += `<div class="task-class"><div class="task-class-name">üìå ${taskClass.name}</div>`;

                    taskClass.tasks.forEach(task => {
                        const taskTotal = task.hours_per_week;
                        const taskSaved = task.hours_saved_per_week;
                        const taskRemaining = taskTotal - taskSaved;
                        const taskPct = Math.round((taskSaved / taskTotal) * 100);
                        
                        const manualWidth = (taskRemaining / taskTotal) * 100;
                        const autoWidth = (taskSaved / taskTotal) * 100;

                        flyoutHTML += `
                            <div class="task-item">
                                <div class="task-name">‚Ä¢ ${task.task}</div>
                                <div class="task-bar-container">
                                    <div class="task-bar">
                                        <div class="task-bar-manual" style="width: ${manualWidth}%">
                                            ${manualWidth > 15 ? `${taskRemaining.toFixed(2)}h` : ''}
                                        </div>
                                        <div class="task-bar-auto" style="width: ${autoWidth}%">
                                            ${autoWidth > 15 ? `${taskSaved.toFixed(2)}h` : ''}
                                        </div>
                                    </div>
                                    <div class="task-hours">${taskTotal.toFixed(2)}h</div>
                                    <div class="task-pct">${taskPct}%</div>
                                </div>
                            </div>
                        `;
                    });

                    flyoutHTML += `</div>`;
                });

                flyoutHTML += `<button class="close-button" onclick="toggleFlyout(${index})">‚úï Close Details</button>`;
                flyout.innerHTML = flyoutHTML;
                flyoutContainer.appendChild(flyout);
            });
        }

        // Toggle flyout panels
        function toggleFlyout(index) {
            // Close all other flyouts
            document.querySelectorAll('.flyout-detail').forEach((el, i) => {
                if (i !== index) {
                    el.classList.remove('active');
                }
            });

            // Toggle current flyout
            const flyout = document.getElementById(`flyout-${index}`);
            flyout.classList.toggle('active');

            // Scroll to flyout if opening
            if (flyout.classList.contains('active')) {
                setTimeout(() => {
                    flyout.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            createOverviewChart();
            createCategoryPanels();
        });
    </script>
</body>
</html>
